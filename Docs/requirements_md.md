# 佐渡農作業天気アプリ - 要件定義書

## プロジェクト概要

### プロジェクト名
佐渡農作業天気アプリ（Sado Weather App）

### 目的
佐渡ヶ島の急激な天気変化に対応し、農作業者が「今、作業できるか？」を3秒で判断できる天気予報アプリを提供する。

### ターゲットユーザー
- 佐渡ヶ島の農作業従事者
- 屋外作業を行う人々
- 天気の急変に備えたい地域住民

### 解決する課題
1. 佐渡の急激な天気変化（朝の暴風雨→午後の晴天など）
2. 作業可能時間帯の判断困難
3. 安全な作業計画の立案困難

---

## 機能要件

### 1. 現在天気表示機能（優先度: 最高）

#### 1.1 現在の天気情報
- **表示項目**:
  - 現在気温（℃）
  - 天気アイコン（晴れ、曇り、雨、雷など）
  - 作業適性判定（適/注意/不適）
  - 風速（m/s）と風向
  - 降水量（mm/h）
  - 雷の有無
  - 湿度（%）
  - 視界情報

#### 1.2 作業適性判定アルゴリズム
```
🟢 作業適:
  - 降水量 < 1mm/h
  - 風速 < 10m/s
  - 雷活動なし
  - 視界良好

🟡 要注意:
  - 降水量 1-3mm/h
  - 風速 10-15m/s
  - 雷注意報発令中
  - 霧または雲が多い

🔴 作業不適:
  - 降水量 > 3mm/h
  - 風速 > 15m/s
  - 雷警報発令中
  - 暴風雨
```

#### 1.3 更新頻度
- 自動更新: 10分ごと
- 手動更新: プルダウン操作で即座に更新

---

### 2. タイムライン表示機能（優先度: 最高）

#### 2.1 時間別天気表示
- **表示期間**: 今後24時間（1時間刻み）
- **表示項目**:
  - 時刻
  - 天気アイコン
  - 作業適性（色分け）
  - 気温
  - 降水量
  - 風速

#### 2.2 横スクロール
- 横スクロールで48時間先まで確認可能
- タップで詳細情報を表示

#### 2.3 視覚的表現
- グラフ形式で気温・降水量・風速を表示
- 作業適性を背景色で表現（緑/黄/赤）

---

### 3. 作業可能時間帯表示機能（優先度: 高）

#### 3.1 作業可能時間の抽出
- 24時間のタイムラインから作業適性が「適」の時間帯を抽出
- 連続した時間帯をまとめて表示

#### 3.2 表示形式
```
🟢 14:00 - 16:00 (2時間)
🔴 16:00 - 18:00 (雨予報)
🟢 18:00 - 20:00 (2時間)
```

#### 3.3 作業時間の合計
- 本日の作業可能時間の合計を表示
- 例: 「本日の作業可能時間: 合計4時間」

---

### 4. 雨雲レーダー機能（優先度: 高）

#### 4.1 雨雲の動き表示
- 気象庁の高解像度降水ナウキャストを利用
- 現在〜1時間後までの雨雲の動きを表示
- アニメーション再生機能

#### 4.2 雨雲接近通知
- ユーザーの位置に雨雲が接近する時刻を予測
- 例: 「15:30頃 雨雲接近」

#### 4.3 地図表示
- 佐渡ヶ島の地図上に雨雲を重ねて表示
- ユーザーの現在地をマーカーで表示

---

### 5. 詳細データ表示機能（優先度: 中）

#### 5.1 グラフ表示
- 降水量グラフ（24時間）
- 気温グラフ（24時間）
- 風速グラフ（24時間）
- 湿度グラフ（24時間）

#### 5.2 データの切り替え
- タブまたはドロップダウンでグラフを切り替え
- すべてのグラフを同時表示するオプション

---

### 6. 週間予報機能（優先度: 中）

#### 6.1 7日間予報
- 今日を含む7日間の天気予報
- 各日の最高気温・最低気温
- 降水確率
- 天気概況

#### 6.2 作業適性カレンダー
- 7日間の作業適性を一覧表示
- 作業チャンスの日を強調表示

---

### 7. 警報・注意報表示機能（優先度: 最高）

#### 7.1 警報・注意報の表示
- 気象庁発表の警報・注意報を表示
- 種類: 大雨、洪水、暴風、雷、波浪など

#### 7.2 視覚的強調
- 警報: 赤色で大きく表示
- 注意報: 黄色で表示
- 画面上部に固定表示

#### 7.3 詳細情報
- タップで警報・注意報の詳細を表示
- 発令時刻、対象地域、予想される影響

---

### 8. 通知機能（優先度: 高）

#### 8.1 プッシュ通知
- ブラウザのPush通知APIを利用
- 通知許可のリクエスト

#### 8.2 通知タイミング
1. **作業開始通知**
   - 「まもなく作業可能時間です」
   - 作業可能時間の30分前

2. **天気変化通知**
   - 「1時間後に雨の予報」
   - 雨の1時間前

3. **危険通知**
   - 「雷注意報が発令されました」
   - 警報・注意報発令時に即座に通知

4. **作業再開通知**
   - 「雨が上がりました。30分後に作業可能」
   - 雨が止んだ30分後

#### 8.3 通知設定
- 通知ON/OFF
- 通知時間帯の設定（例: 6:00-18:00のみ）
- 通知タイプの選択（作業開始、天気変化、危険、作業再開）

---

### 9. 位置情報機能（優先度: 最高）

#### 9.1 現在地の自動取得
- ブラウザの位置情報APIを利用
- 初回アクセス時に位置情報の許可をリクエスト

#### 9.2 位置の手動設定
- 位置情報が取得できない場合の代替手段
- 佐渡ヶ島内の地区を選択
- 緯度経度の手動入力

#### 9.3 位置情報の保存
- LocalStorageに位置情報を保存
- 次回アクセス時に自動で読み込み

---

### 10. PWA機能（優先度: 高）

#### 10.1 インストール可能
- Service Workerによるオフライン対応
- ホーム画面への追加

#### 10.2 オフライン機能
- 最後に取得したデータをキャッシュ
- オフライン時でも閲覧可能
- オンライン復帰時に自動更新

#### 10.3 アプリライクな動作
- スプラッシュスクリーン
- 全画面表示
- ネイティブアプリのような操作感

---

## 非機能要件

### 1. パフォーマンス

#### 1.1 初回読み込み時間
- 目標: 3秒以内
- 制約: 低速回線（3G）でも利用可能

#### 1.2 データ更新速度
- API呼び出し: 1秒以内に完了
- UI更新: 瞬時に反映

#### 1.3 メモリ使用量
- 目標: 50MB以下
- モバイルデバイスでも快適に動作

---

### 2. ユーザビリティ

#### 2.1 視認性
- 屋外の日光下でも判読可能な高コントラスト
- 文字サイズ: 最小16px、重要情報は24px以上

#### 2.2 操作性
- 片手操作可能
- タップターゲット: 最小44x44px
- スクロールのスムーズさ

#### 2.3 アクセシビリティ
- 色覚異常への配慮（色だけでなくアイコンと文字を併用）
- スクリーンリーダー対応
- キーボード操作可能

---

### 3. 互換性

#### 3.1 ブラウザ対応
- Chrome: 最新版〜2バージョン前
- Safari: 最新版〜2バージョン前
- Firefox: 最新版〜2バージョン前
- Edge: 最新版〜2バージョン前

#### 3.2 デバイス対応
- スマートフォン（iOS、Android）
- タブレット
- デスクトップ（参考表示）

#### 3.3 画面サイズ
- 最小: 320px幅（iPhone SE）
- 最大: 1920px幅（デスクトップ）

---

### 4. セキュリティ

#### 4.1 データ保護
- HTTPS通信必須
- APIキーの秘匿化（環境変数管理）

#### 4.2 個人情報
- 位置情報はローカルにのみ保存
- 外部への送信なし

---

### 5. 保守性

#### 5.1 コード品質
- TypeScriptによる型安全性
- ESLintによるコード規約チェック
- Prettierによるフォーマット統一

#### 5.2 テスト
- ユニットテスト: 主要ロジックをカバー
- 統合テスト: APIとの連携を確認

#### 5.3 ドキュメント
- コードコメント
- README.md
- API仕様書

---

## 制約条件

### 1. 技術制約
- 無料APIのみ使用
- サーバーレス（静的ホスティング）
- バックエンドなし（フロントエンドのみ）

### 2. コスト制約
- 開発コスト: ゼロ
- 運用コスト: ほぼゼロ（ホスティング代のみ）

### 3. データ制約
- 気象庁API: 公式サポートなし、仕様変更リスク
- Open-Meteo: 商用利用時は出典明記必要
- API呼び出し制限: 各APIの制限内で運用

---

## 将来的な拡張機能（スコープ外）

### フェーズ2の機能
1. 農作業メモ機能
2. 地域コミュニティ機能（情報共有）
3. 音声読み上げ機能
4. ホーム画面ウィジェット
5. 過去データの記録と分析
6. 精度評価機能
7. 多言語対応

### フェーズ3の機能
1. 作物別の作業推奨機能
2. AIによる天気予測の補正
3. ユーザー投稿による実況天気
4. プッシュ通知の高度化（位置連動）

---

## 成功の指標（KPI）

### 定量指標
1. **利用者数**: 佐渡の農家の20%以上が利用
2. **日次アクティブユーザー**: 初月100人、3ヶ月後300人
3. **作業効率改善**: 作業時間の10%向上（ユーザーアンケート）
4. **安全性向上**: 天気急変による作業中断が50%減少

### 定性指標
1. ユーザー満足度: 5段階評価で平均4以上
2. 「3秒で判断できる」という目標の達成
3. 「屋外で見やすい」という評価

---

## リリース計画

### フェーズ1: MVP（Minimum Viable Product）
- **期間**: 開発開始から3週間
- **機能**: 
  - 現在天気表示
  - タイムライン表示
  - 作業可能時間帯表示
  - 警報・注意報表示
  - 位置情報機能
- **ゴール**: 実際の農家に使ってもらいフィードバック収集

### フェーズ1.5: 改善版
- **期間**: MVP後2週間
- **機能追加**:
  - 雨雲レーダー
  - 通知機能
  - PWA対応
- **ゴール**: 日常的に使えるレベルに到達

### フェーズ2: 完成版
- **期間**: 改善版後1ヶ月
- **機能追加**:
  - 週間予報
  - 詳細データグラフ
  - 設定機能の充実
- **ゴール**: 正式リリース、広報活動開始

---

## 付録

### A. 用語集
- **作業適性**: 屋外作業の安全性と効率性を総合的に判断した指標
- **降水ナウキャスト**: 気象庁が提供する1時間先までの降水予測
- **PWA**: Progressive Web App、Webアプリをネイティブアプリのように使える技術

### B. 参考資料
- 気象庁API（非公式）仕様
- Open-Meteo API仕様
- Web Push API仕様
- Service Worker仕様

### C. 連絡先
- プロジェクトリーダー: [名前]
- 技術担当: [名前]
- デザイン担当: [名前]